 # Teams Meeting Minutes Bot Setup Guide,
    ## Prerequisites,
    - Azure subscription,
    - Microsoft 365 tenant with Teams,
    - Node.js 16+ installed,
    - Anthropic API key,
    ,
    ## Step 1: Azure AD App Registration,
    ,
    1. Go to Azure Portal > Azure Active Directory > App Registrations,
    2. Click 'New registration',
    3. Name: 'Meeting Minutes Bot',
    4. Supported account types: 'Accounts in this organizational directory only',
    5. Click 'Register',
    ,
    ## Step 2: Configure API Permissions,
    ,
    In your app registration:,
    1. Go to 'API permissions',
    2. Click 'Add a permission' > 'Microsoft Graph' > 'Application permissions',
    3. Add these permissions:,
       - OnlineMeetings.Read.All,
       - OnlineMeetingTranscript.Read.All,
       - Chat.ReadWrite,
       - Files.ReadWrite.All,
    4. Click 'Grant admin consent' (requires admin),
    ,
    ## Step 3: Create Client Secret,
    ,
    1. Go to 'Certificates & secrets',
    2. Click 'New client secret',
    3. Add description and expiry,
    4. Copy the secret value (you won't see it again!),
    ,
    ## Step 4: Install Dependencies,
    ,
    ```bash,
    npm install,
    ```,
    ,
    ## Step 5: Configure Environment Variables,
    ,
    1. Copy `.env.example` to `.env`,
    2. Fill in your values:,
       - AZURE_CLIENT_ID: From app registration overview,
       - AZURE_CLIENT_SECRET: From step 3,
       - AZURE_TENANT_ID: From app registration overview,
       - ANTHROPIC_API_KEY: Your Claude API key,
    ,
    ## Step 6: Deploy the Service,
    ,
    ### Local Testing,
    ```bash,
    npm start,
    ```,
    ,
    ### Azure Deployment,
    ```bash,
    # Create Azure Web App,
    az webapp up --name meeting-minutes-bot --resource-group your-rg,
    ,
    # Configure environment variables,
    az webapp config appsettings set --name meeting-minutes-bot --resource-group your-rg --settings @.env,
    ```,
    ,
    ## Step 7: Create Teams App,
    ,
    1. Update manifest.json with your app IDs,
    2. Create icons (color.png 192x192, outline.png 32x32),
    3. Zip manifest.json and icons into app.zip,
    4. Go to Teams > Apps > Manage apps > Upload custom app,
    5. Upload app.zip,
    ,
    ## Step 8: Subscribe to Meeting Events,
    ,
    Use Microsoft Graph webhooks to get notified when meetings end:,
    ,
    ```javascript,
    // Subscription creation (add this to your service),
    POST https://graph.microsoft.com/v1.0/subscriptions,
    {,
      'changeType': 'updated',,
      'notificationUrl': 'https://your-app.azurewebsites.net/webhook/meeting-ended',,
      'resource': '/communications/onlineMeetings',,
      'expirationDateTime': '2024-12-31T18:23:45.9356913Z',,
      'clientState': 'secretClientValue',
    },
    ```,
    ,
    ## Usage,
    ,
    1. Install the bot in your Teams,
    2. Start a meeting with transcription enabled,
    3. When the meeting ends, the bot will:,
       - Wait 30 seconds for transcript processing,
       - Fetch the transcript,
       - Generate meeting minutes using AI,
       - Post the minutes to the meeting chat,
    ,
    ## Troubleshooting,
    ,
    - **No transcript available**: Ensure meeting transcription is enabled,
    - **Permission errors**: Verify admin consent was granted,
    - **Webhook not triggered**: Check subscription is active and URL is correct,
    - **AI errors**: Verify Anthropic API key is valid,
    ,
    ## Important Notes,
    ,
    - Meeting transcription must be enabled by organizer or tenant admin,
    - Transcripts may take 1-5 minutes to become available after meeting ends,
    - Participants must consent to recording/transcription,
    - Ensure compliance with local recording laws,
    ,
    ## Support,
    ,
    For issues, check:,
    - Application logs in Azure,
    - Graph API documentation: https://docs.microsoft.com/graph,
    - Teams app documentation: https://docs.microsoft.com/microsoftteams/platform